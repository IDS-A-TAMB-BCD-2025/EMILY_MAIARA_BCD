USE BD_SUPERMERCADO_FUNCIONARIO_PRODUTO_CONSUMIDOR;

INSERT INTO SUPERMERCADO (SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("123456789000101", "Supermercao Pirim", "19989874147", "pierim@gmail", "Av. Coronel", 132, "Tambaú", "SP");
INSERT INTO SUPERMERCADO (SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("98765432000155", "Supermercado Boa Compra", "11978451236", "boacompra@gmail.com", "Rua das Laranjeiras", 450, "Campinas", "SP");
INSERT INTO SUPERMERCADO (SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("22334455000199", "Supermercado Econômico", "21996325478", "economico.rj@gmail.com", "Av. Atlântica", 1200, "Rio de Janeiro", "RJ");
INSERT INTO SUPERMERCADO (SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("55443322000111", "Supermercado Bom Preço", "31988997766", "bompreco@gmail.com", "Rua das Flores", 89, "Belo Horizonte", "MG");
INSERT INTO SUPERMERCADO (SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("77889966000144", "Supermercado Ideal", "41997654321", "idealmarket@gmail.com", "Av. Curitiba", 1025, "Curitiba", "PR");



INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES("40028922", "Arroz 5KG", 5.0, 500, 26.90, '2025-12-25');
INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES("7891000054321", "Feijão Carioca 1KG", 1.0, 300, 8.49, '2026-03-10');
INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES("7896543210098", "Açúcar Refinado 2KG", 2.0, 250, 6.75, '2026-07-15');
INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES("7891122233344", "Óleo de Soja 900ML", 0.9, 400, 7.29, '2025-11-30');
INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES("7899988776655", "Macarrão Espaguete 500G", 0.5, 600, 4.59, '2027-02-01');


INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES ("53142714956", "Emily", "19995028459", "emily@gmail");
INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES ("48291537684", "Lucas", "11987541236", "lucas.santos@gmail.com");
INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES ("39516284790", "Ana Clara", "21998254711", "anaclara@gmail.com");
INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES ("61483927522", "Pedro Henrique", "31995647821", "pedro.henrique@gmail.com");
INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES ("72849153609", "Mariana", "41998765432", "mariana.souza@gmail.com");


INSERT INTO FUNCIONARIO (FUN_CPF, FUN_NOME, FUN_DATA_NASC, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADIMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES ("53142714598", "Emily Miara", '2008-06-18', "emily@gmail", "carteira_emily", "1967", "1765", '2020-06-08', "8", "55443322000111");
INSERT INTO FUNCIONARIO (FUN_CPF, FUN_NOME, FUN_DATA_NASC, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADIMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES ("48291537421", "Lucas Almeida", '1999-03-22', "lucas.almeida@gmail.com", "carteira_lucas", "1025", "4567", '2021-02-10', "8", "98765432000155");
INSERT INTO FUNCIONARIO (FUN_CPF, FUN_NOME, FUN_DATA_NASC, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADIMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES ("39516284977", "Ana Clara Souza", '2000-09-14', "ana.souza@gmail.com", "carteira_ana", "2031", "8745", '2022-01-15', "6", "22334455000199");
INSERT INTO FUNCIONARIO (FUN_CPF, FUN_NOME, FUN_DATA_NASC, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADIMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES ("61483927544", "Pedro Henrique Silva", '1995-07-09', "pedro.henrique@gmail.com", "carteira_pedro", "1450", "9988", '2019-10-05', "8", "55443322000111");
INSERT INTO FUNCIONARIO (FUN_CPF, FUN_NOME, FUN_DATA_NASC, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADIMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES ("72849153622", "Mariana Lopes", '2002-11-30', "mariana.lopes@gmail.com", "carteira_mariana", "1789", "3321", '2023-04-20', "4", "77889966000144");


INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("123456789000101", 1); -- Supermercado Pirim vende Arroz 5KG
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("98765432000155", 2); -- Boa Compra vende Feijão Carioca
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("22334455000199", 3); -- Econômico vende Açúcar Refinado
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("55443322000111", 4); -- Bom Preço vende Óleo de Soja
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("77889966000144", 5); -- Ideal vende Macarrão Espaguete


INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("53142714956", 1); -- Emily comprou Arroz 5KG
INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("48291537684", 2); -- Lucas comprou Feijão Carioca
INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("39516284790", 3); -- Ana Clara comprou Açúcar Refinado
INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("61483927522", 4); -- Pedro Henrique comprou Óleo de Soja
INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("72849153609", 5); -- Mariana comprou Macarrão Espaguete


SELECT * FROM SUPERMERCADO;

/* CONSULTAR O AUMENTO DE 2 REAIS NO PRECO DE PRODUTOS COM PRECO >= 5 REAIS */

SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_PRECO AS "PREÇO ATUAL", TRUNCATE((PRO_PRECO + 2), 2) AS "PREÇO COM AJUSTE DE R$2,00"
FROM PRODUTO 
WHERE PRO_PRECO >=5;

/* CONSULTAR A REDUÇÃO DE 1 REAL NO PREÇO DOS PRODUTOS PRECO ATUAL<5*/
SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_PRECO AS "PREÇO ATUAL", TRUNCATE((PRO_PRECO - 1), 2) AS "PREÇO COM REDUÇÃO DE R$1,00"
FROM PRODUTO 
WHERE PRO_PRECO <5; 

/* CONSULTAR COMO SERIA APLICAR UM DESCONTO DE 10% EM TODOS OS PRODUTOS */
SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_PRECO AS "PREÇO ATUAL", TRUNCATE((PRO_PRECO - (PRO_PRECO*0.1)), 2) AS "PREÇO COM DESCONTO DE 10%"
FROM PRODUTO; 

/*AJUSTAR O ESTOQUE DO PRIMEIRO PRODUTO DIVIDINDO PELA METADE*/
SELECT PRO_ID, PRO_NOME, PRO_CODIGO_BARRAS, PRO_QUANTIDADE
FROM PRODUTO; 

UPDATE PRODUTO 
SET PRO_QUANTIDADE = PRO_QUANTIDADE / 2
WHERE PRO_ID = 1;

/*CONSULTAR TODOS OS PRODUTOS QUE TENHAM DATA DE VALIDADE ENTRE SETEMBRO/2025 E DEZEMBRO/2025*/
SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_DATA_VALIDADE AS "DATA DE VALIDADE"
FROM PRODUTO 
WHERE PRO_DATA_VALIDADE BETWEEN '2025-09-01' AND '2025-12-31';

/*CONSULTAR TODOS OS PRODUTOS QUE TENHAM PREÇO MAIOR QUE R$10 OU MENOR QUE R$4*/
SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_PRECO AS "PREÇO"
FROM PRODUTO
WHERE PRO_PRECO >=10 OR PRO_PRECO<=4;

/*CONSULTAR OS DDD E TELEFONE DOS CONSUMIDORES SEPARADAMENTE*/
SELECT CON_NOME AS "NOME DO CONSUMIDOR", CON_CPF AS "CPF DO CONSUMIDOR", SUBSTRING(CON_TELEFONE,1,2) AS "DDD DO TELEFONE", SUBSTRING(CON_TELEFONE,3,9) AS "NUMERO DO TELEFONE"
FROM CONSUMIDOR;

/* GERRAR UMA FRASE CONCATENANDO: RAZÃO SICOAL, CNPJ, TELEFONE, EMAIL*/
SELECT CONCAT("RAZÃO SOCIAL: ", CONCAT(SUP_RAZAO_SOCIAL, CONCAT(" | CNPJ: ", CONCAT(SUP_CNPJ, CONCAT(" | TELEFONE: ", CONCAT(SUP_TELEFONE, CONCAT(" | EMAIL: ", SUP_EMAIL))))))) AS FRASE
FROM SUPERMERCADO;

/*GERAR CONSULTA QUE VERIFICA O STATUS DO ESTOQUE DOS PRODUTOS. REGRAS:
1- QTD >=25: ESTOQUE BAIXO
2- QTD >25 E QTD <=100: ESTOQUE MÉDIO
3- QTD >100: ESTOQUE ALTO*/

SELECT PRO_NOME AS "NOME DE PRODUTO", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_QUANTIDADE AS "QUANTIDADE", 
	   CASE
			WHEN PRO_QUANTIDADE <= 25 THEN "ESTOQUE BAIXO"
            WHEN PRO_QUANTIDADE >25 AND PRO_QUANTIDADE < 100 THEN "ESTOQUE MÉDIO"
            WHEN PRO_QUANTIDADE >= 100 THEN "ESTOQUE ALTO"
		END AS "NÍVEL DE ESTOQUE"
FROM PRODUTO;

/*GERAR CONSULTA QUE VERIFICA O PESO DOS PRODUTOS. REGRAS:
1- PESO >=5: PESO BAIXO
2- PESO >5 E QTD <=50: PESO MÉDIO
3- PESO >50: PESO ALTO*/

SELECT PRO_NOME AS "NOME DE PRODUTO", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_PESO AS "PESO", 
	   CASE
			WHEN PRO_PESO <= 5 THEN "PESO BAIXO"
            WHEN PRO_PESO >5 AND PRO_QUANTIDADE < 50 THEN "PESO MÉDIO"
            WHEN PRO_PESO >= 50 THEN "PESO ALTO"
		END AS "BALANÇA DE PESOS"
FROM PRODUTO;

/*CONTAR QUANTOS CONSUMIDORES, PRODUTOS, SUPERMERCADOS E FUNCIONARIOS TEMOS CADASTRADOR*/
SELECT COUNT(*)
FROM CONSUMIDOR;

SELECT COUNT(*)
FROM FUNCIONARIO;

SELECT COUNT(*)
FROM SUPERMERCADO;

SELECT COUNT(*)
FROM PRODUTO;

/*SOMAR O PRECO TOTAL DE TODOS OS PRODUTOS CADASTRADOS*/
SELECT SUM(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$ ", TRUNCATE(SUM(PRO_PRECO),2)) AS "SOMA TOTAL"
FROM PRODUTO;

/*calcular a media de preços dos produtos*/
SELECT AVG(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$ ", TRUNCATE(AVG(PRO_PRECO),2)) AS "MÉDIA DE PREÇO"
FROM PRODUTO;

/*SELECIONAR O PRODUTO MAIS CARO*/
SELECT MAX(PRO_PRECO)
FROM PRODUTO;

/*SELECIONAR O ESTOQUE COM MAIOR QUANTIDADE*/
SELECT MAX(PRO_QUANTIDADE)
FROM PRODUTO;

/*SELECIONAR O ESTOQUE COM MENOR PREÇO*/
SELECT MIN(PRO_PRECO)
FROM PRODUTO;

/*SELECIONAR O ESTOQUE COM MENOR QTD*/
SELECT MIN(PRO_QUANTIDADE)
FROM PRODUTO;

/*SELECIONAR DATA E HORA ATUAL*/
SELECT NOW() FROM DUAL;

SELECT FUN_NOME AS "NOME DO FUNCIONARIO", 
DATE_FORMAT(FUN_DATA_NASC, "%d/%m/%Y") AS "DATA DE NASCIMENTO",
TIMESTAMPDIFF(YEAR,FUN_DATA_NASC, NOW()) AS "IDADE"
FROM FUNCIONARIO;

/*FUNÇOES MATEAMTICAS:
ABS - VALOR ABSOLUTO DE UM Nº
ROUND - ARREDONDAR
POWER - POTENCIA*/

SELECT ABS(-10),
ROUND(PRO_PRECO) AS "PREÇO ARREDONDAO",
POWER(PRO_PRECO,2) AS "PREÇO ELEVADO AO QUADRADO"
FROM PRODUTO;

/*UPPER, LOWER, TRIM*/
SELECT UPPER(FUN_NOME) AS "MAIÚSCULAS", 
LOWER(FUN_NOME) AS "MINUSCULAS",
TRIM("    EMILY") AS "TIRANDO ESPAÇOS"
FROM FUNCIONARIO;


/*AGRUPAMENTOS- GROUP BY*/
SELECT PRO_QUANTIDADE, 
	   COUNT(*)AS "REPETIÇÕES"
FROM PRODUTO
GROUP BY PRO_QUANTIDADE;

/*UNION- UNIR COISAS*/
/*UNION ALL- EXIBE TUDO E DUPLICADO, UNION- EXIBE SEM AS REPETIÇÃO*/
SELECT FUN_NOME, FUN_CPF
FROM FUNCIONARIO
UNION SELECT FUN_NOME, FUN_CPF
FROM FUNCIONARIO;

SELECT * FROM PRODUTO;

/*UNION*/
SELECT PRO_NOME
FROM PRODUTO
UNION SELECT "Arroz 5KG"
FROM DUAL /*TABELA FICTICIA NA HORA DE EXIBIR*/
UNION SELECT  "Iorgut do Bob Esponja"
FROM DUAL;

/*UNION ALL*/
SELECT PRO_NOME
FROM PRODUTO
UNION ALL SELECT "Arroz 5KG"
FROM DUAL /*TABELA FICTICIA NA HORA DE EXIBIR*/
UNION ALL SELECT  "Iorgut do Bob Esponja"
FROM DUAL;

/*SELECT COM WHERE*/

/*RETORNAR IDADE ESPECIFICA*/
SELECT FUN_NOME AS "NOME DO FUNCIONARIO", FUN_CPF AS "CPF DO FUNCIONARIO", FUN_DATA_NASC AS "DATA DE NASCIMENTO", TIMESTAMPDIFF (YEAR, FUN_DATA_NASC,NOW()) AS "IDADE"
FROM FUNCIONARIO
WHERE TIMESTAMPDIFF (YEAR, FUN_DATA_NASC,NOW())>=25 AND TIMESTAMPDIFF (YEAR, FUN_DATA_NASC,NOW())<=35;

/*RETORNAR EMAILS ESPECIFICOS*/
SELECT CON_NOME AS "NOME", CON_CPF AS "CPF/CNPJ", CON_TELEFONE AS "TELEFONE", CON_EMAIL AS "EMAIL", "CONSUMIDOR" AS "TIPO"
FROM CONSUMIDOR
WHERE UPPER(CON_EMAIL) LIKE "%GMAIL%" OR UPPER(CON_EMAIL) LIKE "%OUTLOOK%"
UNION 
SELECT FUN_NOME AS "NOME", FUN_CPF AS "CPF/CNPJ", FUN_TELEFONE AS "TELEFONE", FUN_EMAIL AS "EMAIL", "FUNIONARIO" AS "TIPO"
FROM FUNCIONARIO
WHERE UPPER(FUN_EMAIL) LIKE "%GMAIL%" OR UPPER(FUN_EMAIL) LIKE "%OUTLOOK%"
UNION 
SELECT SUP_RAZAO_SOCIAL AS "NOME", SUP_CNPJ AS "CPF/CNPJ", SUP_TELEFONE AS "TELEFONE", SUP_EMAIL AS "EMAIL", "SUPERMERCADO" AS "TIPO"
FROM SUPERMERCADO
WHERE UPPER(SUP_EMAIL) LIKE "%GMAIL%" OR UPPER(SUP_EMAIL) LIKE "%OUTLOOK%";

/*CROSS JOIN: RETORNA TODOS OS PRODUTOS E OS MERCADOS Q SAO VENDIDOS*/
SELECT PRODUTO.PRO_NOME AS "NOME", PRODUTO.PRO_CODIGO_BARRAS AS "CODIGO DE BARRAS", SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZÃO SOCIAL"
FROM SUPERMERCADO_PRODUTO
CROSS JOIN SUPERMERCADO
CROSS JOIN PRODUTO
WHERE PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID
AND SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ;

/*INNER JOIN- APENAS OS PRODUTOS QUE FORAM COMPRADOS POR ALGUM CONSUMIDOR*/
SELECT PRODUTO_CONSUMIDOR.PCO_ID AS "ID DA COMPRA", PRODUTO.PRO_NOME AS "NOME DO PRODUTO", PRODUTO.PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", CONSUMIDOR.CON_CPF AS "CPF DO CONSUMIDOR"
FROM PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID) 
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*EX CON INNER JOIN- RETORNAR OS FUNCIONARIOS QUE TRABALHAM EM UM MERCADO E MOSTRAR O NOME DO FUNCIO E DO MERCADO Q ELE TRAMPA*/
SELECT FUN_NOME AS "NOME DO FUNCIONARIO", SUP_RAZAO_SOCIAL AS "NOME DO SUPERMERCADO"
FROM FUNCIONARIO
INNER JOIN SUPERMERCADO ON (FK_SUP_CNPJ = SUP_CNPJ);

/*apenas os produtos q existam em um supermercado*/
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZAO SOCIAL", PRODUTO.PRO_NOME AS "PRODUTO NOME"
FROM SUPERMERCADO_PRODUTO
INNER JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*LEFT JOIN*/
INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("333333", "KitKat", "30", "150", "4.50", "2026-01-01");
SELECT PRODUTO.PRO_NOME, SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM PRODUTO 
LEFT JOIN SUPERMERCADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
LEFT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

SELECT * FROM SUPERMERCADO;
SELECT PRODUTO.PRO_NOME, SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM PRODUTO 
RIGHT JOIN SUPERMERCADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
RIGHT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*SELECT COM LEFT E RIGTH */
SELECT * FROM 
(SELECT S.SUP_RAZAO_SOCIAL AS RAZAO_SOCIAL, F.FUN_NOME AS NOME_FUNCIONARIO, P.PRO_NOME AS NOME_PRODUTO, C.CON_NOME AS NOME_CONSUMIDOR
FROM SUPERMERCADO S
LEFT JOIN FUNCIONARIO F ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
LEFT JOIN SUPERMERCADO_PRODUTO SP ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
LEFT JOIN PRODUTO P ON (SP.FK_PRO_ID = P.PRO_ID)
LEFT JOIN PRODUTO_CONSUMIDOR PC ON (P.PRO_ID = PC.FK_PRO_ID)
LEFT JOIN CONSUMIDOR C ON (PC.FK_CON_CPF = C.CON_CPF)

UNION

SELECT S.SUP_RAZAO_SOCIAL AS RAZAO_SOCIAL, F.FUN_NOME AS NOME_FUNCIONARIO, P.PRO_NOME AS NOME_PRODUTO, C.CON_NOME AS NOME_CONSUMIDOR
FROM SUPERMERCADO S
RIGHT JOIN FUNCIONARIO F ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
RIGHT JOIN SUPERMERCADO_PRODUTO SP ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
RIGHT JOIN PRODUTO P ON (SP.FK_PRO_ID = P.PRO_ID)
RIGHT JOIN PRODUTO_CONSUMIDOR PC ON (P.PRO_ID = PC.FK_PRO_ID)
RIGHT JOIN CONSUMIDOR C ON (PC.FK_CON_CPF = C.CON_CPF)
) SELECT_EXTERNO
ORDER BY SELECT_EXTERNO.RAZAO_SOCIAL ASC, 
		 SELECT_EXTERNO.NOME_FUNCIONARIO DESC,
         SELECT_EXTERNO.NOME_PRODUTO ASC,
         SELECT_EXTERNO.NOME_CONSUMIDOR DESC;
         
/*EXERCICIOS- INNER JOIN*/ 
/*1- SUPERMERCADO E OS PRODUTOS Q ELE VENDE*/
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZAO SOCIAL", PRODUTO.PRO_NOME AS "PRODUTO NOME"
FROM SUPERMERCADO_PRODUTO
INNER JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*2- NOME DO FUNCIONARIO E O NOME DO MERCADO*/
SELECT FUN_NOME AS "NOME DO FUNCIONÁRIO", SUP_RAZAO_SOCIAL 	AS "RAZÃO SOCIAL"
FROM FUNCIONARIO
INNER JOIN	SUPERMERCADO ON (FK_SUP_CNPJ = SUP_CNPJ);

/*3- NOME DO CONSUMIDOR E OS PRODUTOS Q COMPROU*/
SELECT CONSUMIDOR.CON_NOME AS "NOME DO CONSUMIDOR", PRODUTO.PRO_NOME AS "NOME DO PRODUTO"
FROM PRODUTO_CONSUMIDOR
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF)
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID);

/*4- NOME DO PRODUTO E O CONSUMIDOR*/
SELECT PRODUTO.PRO_NOME AS "NOME DO PRODUTO", CONSUMIDOR.CON_NOME AS "NOME DO CONSUMIDOR"
FROM PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID) 
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*5- NOME DO MERCADO E A QTD DOS PRODUTOS*/
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL AS "NOME DO MERCADO", COUNT(*) AS "QUANTIDADE DE PRODUTOS"
FROM SUPERMERCADO_PRODUTO
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
INNER JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)

GROUP BY SUPERMERCADO.SUP_RAZAO_SOCIAL;

/*EXERCICIOS 2- LEFT JOIN*/

/*1-TODOS OS MERCADOS E PRODUTOS*/
SELECT S.SUP_RAZAO_SOCIAL, P.PRO_NOME
FROM SUPERMERCADO S
LEFT JOIN SUPERMERCADO_PRODUTO SP ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
LEFT JOIN PRODUTO P ON (P.PRO_ID = SP.FK_PRO_ID);

/*2- MERCADO E FUNCIONARIOS*/
SELECT FUNCIONARIO.FUN_NOME, SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM FUNCIONARIO
LEFT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

/*3- EXIBA OS CONSUMIDORES E OS PRODUTOS Q COMPRARAM*/
SELECT C.CON_NOME, P.PRO_NOME
FROM CONSUMIDOR C
LEFT JOIN PRODUTO_CONSUMIDOR PC ON (C.CON_CPF = PC.FK_CON_CPF)
LEFT JOIN PRODUTO P ON (P.PRO_ID = PC.FK_PRO_ID);

/*4- LISTE OS CONSUMIDORES E OS PRODUTOS Q COMPRARAM*/
SELECT P.PRO_NOME, C.CON_NOME
FROM PRODUTO P
LEFT JOIN PRODUTO_CONSUMIDOR PC ON (P.PRO_ID = PC.FK_PRO_ID)
LEFT JOIN CONSUMIDOR C ON (C.CON_CPF = PC.FK_CON_CPF);

/*5-*/
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL, FUNCIONARIO.FUN_NOME
FROM SUPERMERCADO 
LEFT JOIN FUNCIONARIO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

/*RIGHT JOIN*/
/*1- PRODUTO MERCADO*/
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL, PRODUTO.PRO_NOME
FROM SUPERMERCADO 
RIGHT JOIN SUPERMERCADO_PRODUTO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
RIGHT JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID);

/*2- CONSUMIOR PRODUTO*/
SELECT 	C.CON_NOME, P.PRO_NOME
FROM CONSUMIDOR C
RIGHT JOIN PRODUTO_CONSUMIDOR PC ON (C.CON_CPF = PC.FK_CON_CPF)
RIGHT JOIN PRODUTO P ON (P.PRO_ID = PC.FK_PRO_ID);

/*3- FUNCIONARIO E MERCADO*/
SELECT 	F.FUN_NOME, S.SUP_RAZAO_SOCIAL
FROM FUNCIONARIO F 
RIGHT JOIN SUPERMERCADO S ON (S.SUP_CNPJ = F.FK_SUP_CNPJ);

/*4-*/
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL, PRODUTO.PRO_NOME
FROM SUPERMERCADO 
RIGHT JOIN SUPERMERCADO_PRODUTO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
RIGHT JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID);

/*5-CONSUMIDOR E PRODUTOS*/
SELECT 	C.CON_NOME, P.PRO_NOME
FROM CONSUMIDOR C
RIGHT JOIN PRODUTO_CONSUMIDOR PC ON (C.CON_CPF = PC.FK_CON_CPF)
RIGHT JOIN PRODUTO P ON (P.PRO_ID = PC.FK_PRO_ID);

/*SUBCONSULTA*/
/*SELECIONAR APENAS OS PRODUTOS QUE POSSUEM UM REGISTRO EM UM MERCADO E QUE FORAM COMPRADOS POR UM CONSUMIDOR*/
SELECT P.PRO_NOME AS "NOME DO PRODUTO", P.PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", P.PRO_PRECO AS "PREÇO DO PRODUTO"
FROM PRODUTO P
WHERE P.PRO_ID IN (SELECT SP.FK_PRO_ID FROM SUPERMERCADO_PRODUTO SP)
AND P.PRO_ID IN (SELECT PC.FK_PRO_ID FROM PRODUTO_CONSUMIDOR PC);

/*SELECIONAR APENAS OS PRODUTOS QUE NAO POSSUEM UM REGISTRO EM UM MERCADO E QUE NAO FORAM COMPRADOS POR UM CONSUMIDOR*/
SELECT P.PRO_NOME AS "NOME DO PRODUTO", P.PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", P.PRO_PRECO AS "PREÇO DO PRODUTO"
FROM PRODUTO P
WHERE P.PRO_ID NOT IN (SELECT SP.FK_PRO_ID FROM SUPERMERCADO_PRODUTO SP)
AND P.PRO_ID NOT IN (SELECT PC.FK_PRO_ID FROM PRODUTO_CONSUMIDOR PC);

/*SELECIONAR OS MERCADOS QUE TEM O PRECO DE TODOS OS PRODUTOS MENOR QUE DEZ*/
SELECT S.SUP_RAZAO_SOCIAL 
FROM SUPERMERCADO S
WHERE 10>ALL (
				SELECT P.PRO_PRECO FROM PRODUTO P
);

/*LISTAR TODOS OS PRODUTOS CUJO PRECO SEJA MAIOR Q O PRECO DE QLQR PRODUTO VENDIDO NO MERCADO COM CNPJ 123456789000101*/
SELECT PRO_NOME, PRO_PRECO
FROM PRODUTO
WHERE PRO_PRECO > ANY (
						SELECT PRO_PRECO
                        FROM PRODUTO P
                        INNER JOIN SUPERMERCADO_PRODUTO SP
                        ON (P.PRO_ID = SP.FK_PRO_ID)
                        WHERE SP.FK_SUP_CNPJ = '123456789000101'
);

/*LISTAR TODOS OS CONSUMIDORES Q COMPRARAM PLMNS UM PRODUTO (N VAI APARECE O PRODUTO???)*/
SELECT C.CON_NOME, C.CON_CPF
FROM CONSUMIDOR C
WHERE EXISTS (
			SELECT 1
            FROM PRODUTO_CONSUMIDOR PC
            WHERE PC.FK_CON_CPF = C.CON_CPF
);

/*LISTAR TODOS OS CONSUMIDORES Q NAO COMPRARAM PLMNS UM PRODUTO*/
SELECT C.CON_NOME, C.CON_CPF
FROM CONSUMIDOR C
WHERE NOT EXISTS (
			SELECT 1
            FROM PRODUTO_CONSUMIDOR PC
            WHERE PC.FK_CON_CPF = C.CON_CPF
);